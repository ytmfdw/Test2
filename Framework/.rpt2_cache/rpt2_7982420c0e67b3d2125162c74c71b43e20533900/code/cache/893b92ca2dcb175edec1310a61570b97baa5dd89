{
  "code": "import { ui } from \"../ui/layaMaxUI\";\r\nimport { AppConfig } from \"../AppConfig\";\r\nimport Log from \"../utils/Log\";\r\nimport UiManager from \"../UiManager\";\r\nimport LevelPage from \"./LevelPage\";\r\nimport { getGradeName } from \"../utils/Question\";\r\nimport LevelDetailItem, { STATE_LOCKED, STATE_SELECTED, STATE_NORMAL } from \"../item/LevelDetailItem\";\r\nexport default class LevelDetailPage extends ui.page.LevelDetailPageUI {\r\n    constructor() {\r\n        super();\r\n        this.grade = 1;\r\n        this.hasPassLevel = 0;\r\n        this.totalLevel = AppConfig.GRADE_COUNT;\r\n        this.itemMarginX = 100;\r\n        this.itemMarginY = 50;\r\n        this.height = AppConfig.screenH;\r\n        this.topLayout.y = AppConfig.topFixOffset;\r\n        this.contentLayout.y = this.topLayout.y + this.topLayout.height;\r\n        this.topBg.y = -this.topLayout.y;\r\n        this.topBg.height = this.topLayout.height + this.topLayout.y;\r\n        this.btnHome.on(Laya.Event.CLICK, this, this.backClick);\r\n        this.bannerLayout.y = this.contentLayout.y + this.contentLayout.height;\r\n    }\r\n    onEnable() {\r\n        Log.d(\"LevelDetailPage   onEnable\");\r\n    }\r\n    onDisable() {\r\n        Log.d(\"LevelDetailPage onDisable\");\r\n    }\r\n    backClick(e) {\r\n        e.stopPropagation();\r\n        UiManager.getSelf().gotoPage(LevelPage.getSelf());\r\n        LevelPage.getSelf().init(AppConfig.maxLevel, AppConfig.userData.level);\r\n    }\r\n    static getSelf() {\r\n        if (LevelDetailPage.self == null) {\r\n            LevelDetailPage.self = new LevelDetailPage();\r\n        }\r\n        return LevelDetailPage.self;\r\n    }\r\n    init(grade, userLevel) {\r\n        this.levelLabel.text = getGradeName(grade);\r\n        this.grade = grade;\r\n        this.itemPanel.removeChildren(0, this.itemPanel.numChildren);\r\n        if (grade == AppConfig.totalGrade) {\r\n            this.totalLevel = AppConfig.maxLevel - (grade - 1) * AppConfig.GRADE_COUNT;\r\n            ;\r\n        }\r\n        else {\r\n            this.totalLevel = AppConfig.GRADE_COUNT;\r\n        }\r\n        let userGrade = Math.ceil((userLevel % AppConfig.GRADE_COUNT == 0 ? (userLevel + 1) : userLevel) / AppConfig.GRADE_COUNT);\r\n        this.hasPassLevel = this.grade < userGrade ? AppConfig.GRADE_COUNT : userLevel % AppConfig.GRADE_COUNT;\r\n        this.passLabel.text = this.hasPassLevel + \" / \" + this.totalLevel;\r\n        for (var i = 0; i < this.totalLevel; i++) {\r\n            var tmpItem = Laya.Pool.getItemByClass(\"LevelDetailItem\", LevelDetailItem);\r\n            var x = i % AppConfig.BonusCount;\r\n            var y = Math.floor(i / AppConfig.BonusCount);\r\n            tmpItem.pos(x * (tmpItem.width + this.itemMarginX), y * (tmpItem.height + this.itemMarginY));\r\n            if (y == 2) {\r\n                tmpItem.x = 200;\r\n            }\r\n            if (i > this.hasPassLevel) {\r\n                tmpItem.init(this.grade, i + 1, STATE_LOCKED);\r\n            }\r\n            else if (i === this.hasPassLevel) {\r\n                tmpItem.init(this.grade, i + 1, STATE_SELECTED);\r\n            }\r\n            else {\r\n                tmpItem.init(this.grade, i + 1, STATE_NORMAL);\r\n            }\r\n            this.itemPanel.addChild(tmpItem);\r\n        }\r\n    }\r\n}\r\nLevelDetailPage.self = null;\r\n",
  "references": [
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/ui/layaMaxUI.ts",
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/AppConfig.ts",
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/utils/Log.ts",
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/UiManager.ts",
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/page/LevelPage.ts",
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/utils/Question.ts",
    "E:/game/Growup/Laya2Framework/Framework/Framework/src/item/LevelDetailItem.ts"
  ]
}
